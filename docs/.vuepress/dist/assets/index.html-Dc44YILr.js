import{_ as e,r as h,o as t,c as k,a as i,b as s,d as n,e as a}from"./app-B6iXF0Jq.js";const r={},d=a('<h2 id="infercnv使用流程" tabindex="-1"><a class="header-anchor" href="#infercnv使用流程"><span>inferCNV使用流程</span></a></h2><h3 id="infercnv简介" tabindex="-1"><a class="header-anchor" href="#infercnv简介"><span>inferCNV简介</span></a></h3><p><strong>inferCNV</strong>可以被用于单细胞RNA-seq数据识别大规模的染色体拷贝数变异，如：整个染色体或是大染色体片段的获得和缺失。主要是通过与一组参考“正常”细胞相比，探索肿瘤基因组不同位置基因表达强度来实现。生成的热图可以显示每条染色体的相对表达强度。通过与正常细胞相比，很容易看出肿瘤基因组哪些区域表达过于丰富或者不够丰富。</p><h3 id="infercnv安装" tabindex="-1"><a class="header-anchor" href="#infercnv安装"><span>inferCNV安装</span></a></h3>',4),p={href:"https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/",target:"_blank",rel:"noopener noreferrer"},g=i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"if"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"!"),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"requireNamespace"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"BiocManager"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", "),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"quietly"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}}," TRUE"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"     install.packages"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"BiocManager"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"BiocManager"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"::"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"install"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"infercnv"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1),c=i("h3",{id:"infercnv运行",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#infercnv运行"},[i("span",null,"inferCNV运行")])],-1),o=i("p",null,"inferCNV可以通过两步进行运行：",-1),D=i("p",null,[i("strong",null,"首先需要创建一个inferCNV对象"),s("。")],-1),B=i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," CreateInfercnvObject"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"raw_counts_matrix"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"system.file"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"extdata"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},' "'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"oligodendroglioma_expression_downsampled.counts.matrix.gz"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," package"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},' "'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"infercnv"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                                    annotations_file"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"system.file"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"extdata"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},",            "),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"oligodendroglioma_annotations_downsampled.txt"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", "),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"package"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},' "'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"infercnv"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"),")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                                    delim"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}},"\\t"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                                    gene_order_file"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"system.file"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"extdata"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", "),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"gencode_downsampled.EXAMPLE_ONLY_DONT_REUSE.txt"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", "),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"package"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},' "'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"infercnv"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"), "),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"ref_group_names"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"c"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Microglia/Macrophage"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},","),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},"Oligodendrocytes (non-malignant)"),i("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},'"'),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"))")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1),A=i("p",null,"需要的输入文件有三个：",-1),y=i("ul",null,[i("li",null,[i("p",null,[i("strong",null,"Raw Counts Matrix for Genes x Cells")]),i("p",null,[i("strong",null,"inferCNV"),s("可以兼容来自"),i("code",null,"smart-seq2"),s("和"),i("code",null,"10x genmoic"),s("等单细胞测序平台的数据，count矩阵必须行是基因，列是细胞的矩阵，格式如下：")]),i("table",null,[i("thead",null,[i("tr",null,[i("th"),i("th",null,"MGH54_P16_F12"),i("th",null,"MGH54_P12_C10"),i("th",null,"MGH54_P11_C11"),i("th",null,"MGH54_P15_D06"),i("th",null,"...")])]),i("tbody",null,[i("tr",null,[i("td",null,"A2M"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"...")]),i("tr",null,[i("td",null,"AAAS"),i("td",null,"0"),i("td",null,"37"),i("td",null,"30"),i("td",null,"21"),i("td",null,"...")]),i("tr",null,[i("td",null,"AACS"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"...")]),i("tr",null,[i("td",null,"AADAT"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"0"),i("td",null,"...")]),i("tr",null,[i("td",null,"..."),i("td",null,"..."),i("td",null,"..."),i("td",null,"..."),i("td",null,"..."),i("td",null,"...")])])])]),i("li",null,[i("p",null,[i("strong",null,"Sample annotation file")]),i("p",null,[s("样本注释文件包括两列：第一列是细胞名字，第二列是细胞的类型，以"),i("code",null,"tab"),s("分割。如果已知正常细胞的类型，可以给出具体的细胞类型，并且，在进行计算时，每一种细胞类型都将作为单独的正常细胞存在，而不是整合成一个正常的类型。同样，如果并不能详细的获得正常细胞的类型，可以将其统称为normal，作为统一的正常细胞类型。对于恶性细胞需要标记为"),i("code",null,"malignant_{patient}"),s("的形式。使它们在聚类时可以聚在一起。")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH54_P2_C12"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    Microglia"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"/"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"Macrophage")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH36_P6_F03"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    Microglia"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"/"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"Macrophage")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH54_P16_F12"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   Oligodendrocytes"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"non"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH54_P12_C10"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   Oligodendrocytes"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"non"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH36_P1_B02"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    malignant_MGH36")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MGH36_P1_H10"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    malignant_MGH36")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])])]),i("li",null,[i("p",null,[i("strong",null,"Gene ordering file")]),i("p",null,[s("Gene ordering文件提供每个基因的染色体位置信息，使用"),i("code",null,"tab"),s("分割。要分析的count矩阵中的每个基因都应该在这个基因排序文件中提供相应的基因名称和位置信息。")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"WASH7P"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"  chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    14363"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   29806")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"LINC00115"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"       chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    761586"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"  762902")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"NOC2L"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    879584"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"  894689")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"MIR200A"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    1103243"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1103332")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"SDF4"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    1152288"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1167411")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"UBE2J2"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"  chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    1189289"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 1209265")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])])])],-1),u=i("blockquote",null,[i("p",null,[s("注意，如果没有参考的正常细胞，可以设置"),i("code",null,"ref_group_names=NULL"),s("，使用所有细胞的平均表达作为参考基线。")]),i("p",null,[s("此外，inferCNV默认已经去除低质量的细胞，如果要进一步进行最大或最小count值的过滤，可以设置"),i("code",null,"min_max_counts_per_cell=c(1e5,1e6)")])],-1),m=i("p",null,[i("strong",null,[s("在创建"),i("code",null,"infercnv_obj"),s("对象之后，使用内置的"),i("code",null,"infercnv::run()"),s("方法运行标准的infercnv过程：")])],-1),_=i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," infercnv"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"::"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"run"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cutoff"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," # cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             out_dir"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#998418","--shiki-dark":"#B8A965"}},"tempfile"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},"("),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},")"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cluster_by_groups"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"TRUE"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},", ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             denoise"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"TRUE"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             HMM"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"TRUE"),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}},")")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1),v=i("p",null,[i("code",null,"cutoff"),s("决定了哪个基因可以被用于infercnv分析")],-1),C=i("p",null,[i("code",null,"cluster_by_groups"),s("可以根据细胞注释文件对细胞进行聚类")],-1),f=i("h3",{id:"infercnv降噪处理",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#infercnv降噪处理"},[i("span",null,"inferCNV降噪处理")])],-1),b=i("p",null,"降噪处理可以降低噪声对与表达的影响，同时保留在肿瘤细胞中的表达",-1),M=i("ol",null,[i("li",null,[i("p",null,"使用固定阈值过滤"),i("p",null,[s("可以使用"),i("code",null,"noise_filter"),s("参数设定一个特定的偏离均值的阈值")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," infercnv"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"::"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"run"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cutoff"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," # cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             out_dir"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"out_dir"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cluster_by_groups"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"T"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             plot_steps"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"F"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             denoise"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"T"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," ## de noise")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             noise_filter"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"0.1"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"   ## hard thresholds")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"                             )")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])]),i("p",null,[i("img",{src:"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/denoise_hard_filter.png",alt:""})])]),i("li",null,[i("p",null,"使用动态阈值过滤"),i("p",null,[s("默认情况下，用于去噪的硬边界是基于剩余的正常表达值的标准差来计算的。这个阈值可以使用"),i("code",null,"sd_amplifier"),s("参数进行调整。例如，我们可以使用1.5 *标准差的过滤如下:")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}}," ="),i("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," infercnv"),i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"::"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"run"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"("),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"infercnv_obj"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cutoff"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}}," # cutoff=1 works well for Smart-seq2, and cutoff=0.1 works well for 10x Genomics")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             out_dir"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"out_dir"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             cluster_by_groups"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"T"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},","),i("span",{style:{"--shiki-light":"#393A34","--shiki-dark":"#DBD7CAEE"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             plot_steps"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"F"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             denoise"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"T"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                             sd_amplifier"),i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"="),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"1.5"),i("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"  ## set dynamic thresholding based on the standard deviation value.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#999999","--shiki-dark":"#666666"}},"                             )")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])]),i("p",null,[i("img",{src:"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/denoise_dynamic_sd.png",alt:""})])])],-1),E=a('<h3 id="基于hmm的cnv预测方法" tabindex="-1"><a class="header-anchor" href="#基于hmm的cnv预测方法"><span>基于HMM的CNV预测方法</span></a></h3><p>inferCNV当前支持两种基于HMM的CNV预测方法（i3和i6）。两种方法可以通过<code>infercnv::run()</code>函数中的<code>HMM_type</code>参数进行设定，默认为<code>HMM_type=&#39;i6</code></p><p>两种方法的操作对象都是对<code>CreateInfercnvObject()</code>函数计算出来的<code>infercnv</code>对象进行处理。</p>',3),N={href:"https://github.com/broadinstitute/infercnv/wiki/infercnv-i3-HMM-type",target:"_blank",rel:"noopener noreferrer"},H={href:"https://github.com/broadinstitute/infercnv/wiki/infercnv-i6-HMM-type",target:"_blank",rel:"noopener noreferrer"},F=i("ul",null,[i("li",null,"0x: complete loss"),i("li",null,"0.5x: loss of one copy"),i("li",null,"1x: neutral"),i("li",null,"1.5x: addition of one copy"),i("li",null,"2x: addition of two copies"),i("li",null,"3x: essentially a placeholder for >2x copies but modeled as 3x")],-1),G=i("h3",{id:"cnv-region预测报告",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#cnv-region预测报告"},[i("span",null,"CNV region预测报告")])],-1),V=i("p",null,"CNV的推断预测结果包含在以下文件夹中：",-1),x=i("ul",null,[i("li",null,[i("p",null,[i("code",null,"HMM_CNV_predictions.*.pred_cnv_regions.dat"),s(" ：包含CNV区域坐标、状态分配和细胞分组的摘要信息。")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"cell_group_name"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                         cnv_name"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"        state"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   chr"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     start"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    3696784"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 144612683")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_4"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   1.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    151336778"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"       156213123")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr3"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_7"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   1.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr3"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    3168600"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 10285427")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr3"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_9"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   1.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr3"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    45429998"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"        49460186")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr4"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_11"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"  0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr4"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    53179"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   187134610")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr5"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_13"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"  1.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     chr5"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    134181370"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"       177037348")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])])]),i("li",null,[i("p",null,[i("code",null,"HMM_CNV_predictions.*.cell_groupings"),s(": 提供肿瘤subcluster和细胞成员的对应关系")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"cell_group_name"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                         cell")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P3_E06")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P10_E07")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P3_C04")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P3_A09")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P2_A08")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P10_B08")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      MGH36_P8_H09")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"...")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])])]),i("li",null,[i("p",null,[i("code",null,"HMM_CNV_predictions.*.pred_cnv_genes.dat"),s(": 包含每个细胞、每个基因的CNV状态分级情况")]),i("div",{class:"language-r line-numbers-mode","data-ext":"r","data-title":"r"},[i("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"cell_group_name"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"                         gene_region_name"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}}," state"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   gene"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    chr"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     start"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   end")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     DFFB"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    3696784"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 3713068")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     C1orf174"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"        chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    3773845"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 3801993")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     RPL22"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    3805689"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 3816857")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     ICMT"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    6241329"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 6269449")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     ACOT7"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"   chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    6281253"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 6296032")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     NOL9"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"    chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    6324329"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 6454451")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"malignant_MGH36.malignant_MGH36_s1"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"      chr1"),i("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}},"-"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"region_2"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"   0.5"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"     KLHL21"),i("span",{style:{"--shiki-light":"#B07D48","--shiki-dark":"#BD976A"}},"  chr1"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}},"    6581407"),i("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 6614595")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#1E754F","--shiki-dark":"#4D9375"}},"...")])])]),i("div",{class:"line-numbers","aria-hidden":"true"},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])])]),i("li",null,[i("p",null,[i("code",null,"HMM_CNV_predictions.*.genes_used.dat"),s(": 提供在分析中使用的基因列表")])])],-1),w=a('<h3 id="推断肿瘤subclusters" tabindex="-1"><a class="header-anchor" href="#推断肿瘤subclusters"><span>推断肿瘤subclusters</span></a></h3><p>通过设置 <code>infercnv::run(analysis_mode=&#39;subclusters&#39;)</code>, inferCNV会试着根据CNV改变的模式对细胞进行聚类。</p><p>在inferCNV中，使用的聚类方式为层次聚类（hierarchical clustering），根据层次聚类树划分不同的subcluster。有三个参数可以影响层次聚类划分的结果：</p><ul><li><code>infercnv::run(hclust_method=&#39;ward.D2&#39;)</code>：层次聚类使用的方法，支持所有的<code>hclust</code>方法。目前作者认为<code>ward.D2</code>的效果最好</li><li><code>infercnv::run(tumor_subcluster_partition_method=&#39;random_trees&#39;)</code>：划分层次聚类树的方法。可选的方法为：<code>random_trees</code>, <code>qnorm</code></li><li><code>infercnv::run(tumor_subcluster_pval=0.05)</code>:用于确定分层树中的切割点的设置</li></ul><h3 id="infercnv的输出" tabindex="-1"><a class="header-anchor" href="#infercnv的输出"><span>inferCNV的输出</span></a></h3><p>通过inferCNV的<code>run</code>函数运行后，会产生一些输出文件：</p><ul><li><code>infercnv.preliminary.png</code>:初步的inferCNV图像</li><li><code>infercnv.png </code>：采用去噪方法，生成最终的热图</li><li><code>infercnv.references.txt</code>：“正常”细胞矩阵数据值</li><li><code>infercnv.observations.txt</code>：肿瘤细胞数据值</li><li><code>infercnv.observation_groupings.txt</code>：聚类后的肿瘤细胞关系</li><li><code>infercnv.observations_dendrogram.txt </code>：肿瘤细胞聚类树状结构图</li></ul><h3 id="解读infercnv图像" tabindex="-1"><a class="header-anchor" href="#解读infercnv图像"><span>解读inferCNV图像</span></a></h3><p>通过inferCNV会得到类似于下面的聚类图：</p><p><img src="https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/infercnv.png" alt=""></p><p>正常细胞的表达值绘制在顶部的热图中，肿瘤细胞绘制在底部的热图中，基因从左到右排列在染色体上。将正常的细胞表达数据从肿瘤细胞表达数据中减去，产生差异，其中染色体区域扩增为红色块，染色体区域缺失为蓝色块。</p><hr><h3 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h3><p>https://github.com/broadinstitute/infercnv/wiki</p>',14);function P(j,T){const l=h("ExternalLinkIcon");return t(),k("div",null,[d,i("p",null,[s("安装inferCNV需要同时安装"),i("a",p,[s("JAGS"),n(l)]),s(" package.")]),g,c,o,D,B,A,y,u,m,_,v,C,f,b,M,E,i("blockquote",null,[i("p",null,[i("a",N,[s("i3 HMM"),n(l)]),s(": 包括CNV的三种状态： 拷贝数缺失（deletion）、拷贝数中立（neutral）、拷贝数扩增（amplification ）")]),i("p",null,[i("a",H,[s("i6 HMM"),n(l)]),s(": 包括更加精细定义六种CNV改变状态：")]),F]),G,V,x,w])}const S=e(r,[["render",P],["__file","index.html.vue"]]),q=JSON.parse(`{"path":"/bioinfo/infercnv/","title":"inferCNV 推断拷贝数","lang":"zh-CN","frontmatter":{"title":"inferCNV 推断拷贝数","author":"Jeason","createTime":"2020/01/09 22:47:45","permalink":"/bioinfo/infercnv/","tags":["biosoftware"],"description":"inferCNV使用流程 inferCNV简介 inferCNV可以被用于单细胞RNA-seq数据识别大规模的染色体拷贝数变异，如：整个染色体或是大染色体片段的获得和缺失。主要是通过与一组参考“正常”细胞相比，探索肿瘤基因组不同位置基因表达强度来实现。生成的热图可以显示每条染色体的相对表达强度。通过与正常细胞相比，很容易看出肿瘤基因组哪些区域表达过于丰...","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"],["meta",{"property":"og:url","content":"https://jeason.netlify.app/bioinfo/infercnv/"}],["meta",{"property":"og:title","content":"inferCNV 推断拷贝数"}],["meta",{"property":"og:description","content":"inferCNV使用流程 inferCNV简介 inferCNV可以被用于单细胞RNA-seq数据识别大规模的染色体拷贝数变异，如：整个染色体或是大染色体片段的获得和缺失。主要是通过与一组参考“正常”细胞相比，探索肿瘤基因组不同位置基因表达强度来实现。生成的热图可以显示每条染色体的相对表达强度。通过与正常细胞相比，很容易看出肿瘤基因组哪些区域表达过于丰..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/denoise_hard_filter.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-13T08:48:54.000Z"}],["meta",{"property":"article:author","content":"Jeason"}],["meta",{"property":"article:tag","content":"biosoftware"}],["meta",{"property":"article:modified_time","content":"2024-05-13T08:48:54.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"inferCNV 推断拷贝数\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/denoise_hard_filter.png\\",\\"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/denoise_dynamic_sd.png\\",\\"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/inferCNV/infercnv.png\\"],\\"dateModified\\":\\"2024-05-13T08:48:54.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jeason\\"}]}"]]},"headers":[{"level":2,"title":"inferCNV使用流程","slug":"infercnv使用流程","link":"#infercnv使用流程","children":[{"level":3,"title":"inferCNV简介","slug":"infercnv简介","link":"#infercnv简介","children":[]},{"level":3,"title":"inferCNV安装","slug":"infercnv安装","link":"#infercnv安装","children":[]},{"level":3,"title":"inferCNV运行","slug":"infercnv运行","link":"#infercnv运行","children":[]},{"level":3,"title":"inferCNV降噪处理","slug":"infercnv降噪处理","link":"#infercnv降噪处理","children":[]},{"level":3,"title":"基于HMM的CNV预测方法","slug":"基于hmm的cnv预测方法","link":"#基于hmm的cnv预测方法","children":[]},{"level":3,"title":"CNV region预测报告","slug":"cnv-region预测报告","link":"#cnv-region预测报告","children":[]},{"level":3,"title":"推断肿瘤subclusters","slug":"推断肿瘤subclusters","link":"#推断肿瘤subclusters","children":[]},{"level":3,"title":"inferCNV的输出","slug":"infercnv的输出","link":"#infercnv的输出","children":[]},{"level":3,"title":"解读inferCNV图像","slug":"解读infercnv图像","link":"#解读infercnv图像","children":[]},{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}]}],"isBlogPost":true,"readingTime":{"minutes":5.85,"words":1754},"git":{"updatedTime":1715590134000},"autoDesc":true,"filePathRelative":"bioinfo/infercnv.md","categoryList":[{"type":10001,"name":"bioinfo"}]}`);export{S as comp,q as data};
