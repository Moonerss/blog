import{_ as i,o as a,c as l,e as s,a as t,b as e}from"./app-B6iXF0Jq.js";const n={},h=s('<h2 id="测序深度-覆盖度" tabindex="-1"><a class="header-anchor" href="#测序深度-覆盖度"><span>测序深度 &amp;&amp; 覆盖度</span></a></h2><div style="text-align:center;"><p><img src="https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/seq_depth/coverage_depth.png" alt=""></p></div><h3 id="测序深度-depth" tabindex="-1"><a class="header-anchor" href="#测序深度-depth"><span>测序深度 (Depth)</span></a></h3><p>基因组被测序片段（短读 short reads）“覆盖”的强度有多大？</p><p>每一碱基的覆盖率是基因组碱基被测序的平均次数。 基因组的覆盖深度是通过与基因组匹配的所有短读的碱基数目除以该基因组的长度来计算的。 它通常表示为1X、2X、3X、…(1、2或3倍覆盖)。</p><p>这里的覆盖率通常被称作测序深度（sequencing depth）或者覆盖深度（depth of coverage）</p><p>测序深度的计算公式如下:</p><ol><li>原始测序数据的深度: Depth = (# sequenced bases) / (# bases of reference)</li><li>比对上的数据的深度: Depth= (# bases of all mapped reads) / (# bases of reference)</li></ol><h3 id="覆盖度-coverage" tabindex="-1"><a class="header-anchor" href="#覆盖度-coverage"><span>覆盖度 (coverage)</span></a></h3><p>短读“覆盖”了基因组的多少区域？是否有些区域没有任何的短读覆盖？</p><p>覆盖范围是参考基因组被一定深度覆盖的碱基的百分比。例如，一个基因组的90%区域在1X深度覆盖，另外仍然有70%的区域被覆盖了5X深度。</p><p>此处通常称为覆盖度（genome covarage）或者覆盖范围（breadth of coverage）。</p><p>覆盖度的计算公式如下:</p><p>Coverage = (# area covered by mapped reads) / (# area of reference)</p><h3 id="计算示例" tabindex="-1"><a class="header-anchor" href="#计算示例"><span>计算示例</span></a></h3><p><img src="https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/seq_depth/types-of-coverage.png" alt=""></p><p>对于全基因组范围:</p><p>Depth = (6 * 28nt) / 112nt = 1.2 fold</p><p>Coverage = (46nt - 5nt) / 112nt = 36.6%</p><p>对于target区域:</p><p>Depth = (6 * 28nt) / 46nt = 3.7 fold</p><p>Coverage = (46nt - 5nt) / 46nt = 89.1%</p><h2 id="计算测序深度和覆盖度" tabindex="-1"><a class="header-anchor" href="#计算测序深度和覆盖度"><span>计算测序深度和覆盖度</span></a></h2><h3 id="samtools" tabindex="-1"><a class="header-anchor" href="#samtools"><span>samtools</span></a></h3>',24),r=t("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[t("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[t("code",null,[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"## 计算每个位点的测序深度")]),e(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"samtools"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," depth"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," samp.bam"),t("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," >"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," base_depth.txt")]),e(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"## 统计平均覆盖度")]),e(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"cat"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," base_depth.txt"),t("span",{style:{"--shiki-light":"#AB5959","--shiki-dark":"#CB7676"}}," |"),t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}}," awk"),t("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}}," '"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}},'{ sum ＋= ＄3; } END { print "coverage = " sum/NR }'),t("span",{style:{"--shiki-light":"#B5695999","--shiki-dark":"#C98A7D99"}},"'")])])]),t("div",{class:"line-numbers","aria-hidden":"true"},[t("div",{class:"line-number"}),t("div",{class:"line-number"}),t("div",{class:"line-number"}),t("div",{class:"line-number"})])],-1),d=t("h3",{id:"bamstats",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#bamstats"},[t("span",null,"BAMStats")])],-1),p=t("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[t("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[t("code",null,[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"sambamba"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," sort"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -o"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," smap.sort.bam"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -t"),t("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 20"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -p"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," samp.bam")]),e(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"java"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -jar"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -Xmx30g"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," BAMStats-1.25.jar"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -i"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," samp.sort.bam"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -o"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," BAMStats"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," --view"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," simple")]),e(`
`),t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"cat"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," BAMStats")])])]),t("div",{class:"line-numbers","aria-hidden":"true"},[t("div",{class:"line-number"}),t("div",{class:"line-number"}),t("div",{class:"line-number"})])],-1),c=s('<table><thead><tr><th style="text-align:center;">ref</th><th style="text-align:center;">N</th><th style="text-align:center;">mean</th><th style="text-align:center;">median</th><th style="text-align:center;">sd</th><th style="text-align:center;">q1</th><th style="text-align:center;">q3</th><th style="text-align:center;">2.50%</th><th style="text-align:center;">97.50%</th><th style="text-align:center;">min</th><th style="text-align:center;">max</th></tr></thead><tbody><tr><td style="text-align:center;">chr1</td><td style="text-align:center;">249,250,621</td><td style="text-align:center;">0.63</td><td style="text-align:center;">0</td><td style="text-align:center;">11.29</td><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">0</td><td style="text-align:center;">3</td><td style="text-align:center;">0</td><td style="text-align:center;">15051</td></tr><tr><td style="text-align:center;">chr2</td><td style="text-align:center;">243,199,373</td><td style="text-align:center;">0.63</td><td style="text-align:center;">0</td><td style="text-align:center;">1.43</td><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">0</td><td style="text-align:center;">3</td><td style="text-align:center;">0</td><td style="text-align:center;">706</td></tr><tr><td style="text-align:center;">chr3</td><td style="text-align:center;">198,022,430</td><td style="text-align:center;">0.64</td><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">0</td><td style="text-align:center;">3</td><td style="text-align:center;">0</td><td style="text-align:center;">102</td></tr><tr><td style="text-align:center;">chr4</td><td style="text-align:center;">191,154,276</td><td style="text-align:center;">0.58</td><td style="text-align:center;">0</td><td style="text-align:center;">1.13</td><td style="text-align:center;">0</td><td style="text-align:center;">1</td><td style="text-align:center;">0</td><td style="text-align:center;">3</td><td style="text-align:center;">0</td><td style="text-align:center;">527</td></tr></tbody></table><h3 id="qualimap" tabindex="-1"><a class="header-anchor" href="#qualimap"><span>Qualimap</span></a></h3>',2),k=t("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[t("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[t("code",null,[t("span",{class:"line"},[t("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"qualimap"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," bamqc"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," --java-mem-size=40G"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -c"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -nt"),t("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 30"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -outdir"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ./"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -outformat"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," PDF"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -os"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -outfile"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," samp.bamqc.pdf"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -bam"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," samp.sort.bam"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -gd"),t("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," hg19"),t("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -nr"),t("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 2000")])])]),t("div",{class:"line-numbers","aria-hidden":"true"},[t("div",{class:"line-number"})])],-1),o=[h,r,d,p,c,k];function g(y,m){return a(),l("div",null,o)}const A=i(n,[["render",g],["__file","index.html.vue"]]),u=JSON.parse(`{"path":"/NGS/seq_length/","title":"测序深度和覆盖度","lang":"zh-CN","frontmatter":{"title":"测序深度和覆盖度","author":"Jeason","createTime":"2024/04/24 20:54:24","permalink":"/NGS/seq_length/","description":"测序深度 && 覆盖度 测序深度 (Depth) 基因组被测序片段（短读 short reads）“覆盖”的强度有多大？ 每一碱基的覆盖率是基因组碱基被测序的平均次数。 基因组的覆盖深度是通过与基因组匹配的所有短读的碱基数目除以该基因组的长度来计算的。 它通常表示为1X、2X、3X、…(1、2或3倍覆盖)。 这里的覆盖率通常被称作测序深度（sequen...","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"],["meta",{"property":"og:url","content":"https://jeason.netlify.app/NGS/seq_length/"}],["meta",{"property":"og:title","content":"测序深度和覆盖度"}],["meta",{"property":"og:description","content":"测序深度 && 覆盖度 测序深度 (Depth) 基因组被测序片段（短读 short reads）“覆盖”的强度有多大？ 每一碱基的覆盖率是基因组碱基被测序的平均次数。 基因组的覆盖深度是通过与基因组匹配的所有短读的碱基数目除以该基因组的长度来计算的。 它通常表示为1X、2X、3X、…(1、2或3倍覆盖)。 这里的覆盖率通常被称作测序深度（sequen..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/seq_depth/coverage_depth.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-13T13:59:34.000Z"}],["meta",{"property":"article:author","content":"Jeason"}],["meta",{"property":"article:modified_time","content":"2024-05-13T13:59:34.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"测序深度和覆盖度\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/seq_depth/coverage_depth.png\\",\\"https://cdn.jsdelivr.net/gh/Moonerss/CDN/paper/seq_depth/types-of-coverage.png\\"],\\"dateModified\\":\\"2024-05-13T13:59:34.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jeason\\"}]}"]]},"headers":[{"level":2,"title":"测序深度 && 覆盖度","slug":"测序深度-覆盖度","link":"#测序深度-覆盖度","children":[{"level":3,"title":"测序深度 (Depth)","slug":"测序深度-depth","link":"#测序深度-depth","children":[]},{"level":3,"title":"覆盖度 (coverage)","slug":"覆盖度-coverage","link":"#覆盖度-coverage","children":[]},{"level":3,"title":"计算示例","slug":"计算示例","link":"#计算示例","children":[]}]},{"level":2,"title":"计算测序深度和覆盖度","slug":"计算测序深度和覆盖度","link":"#计算测序深度和覆盖度","children":[{"level":3,"title":"samtools","slug":"samtools","link":"#samtools","children":[]},{"level":3,"title":"BAMStats","slug":"bamstats","link":"#bamstats","children":[]},{"level":3,"title":"Qualimap","slug":"qualimap","link":"#qualimap","children":[]}]}],"readingTime":{"minutes":1.78,"words":534},"git":{"updatedTime":1715608774000},"autoDesc":true,"filePathRelative":"notes/NGS/seq_length.md"}`);export{A as comp,u as data};
