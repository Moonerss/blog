import{_ as t,r as s,o,c,a as e,b as i,d as l,e as n}from"./app-B6iXF0Jq.js";const d={},r=e("blockquote",null,[e("p",null,"MACS2是peak calling最常用的工具")],-1),h=e("h2",{id:"callpeak用法",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#callpeak用法"},[e("span",null,"callpeak用法")])],-1),p=e("p",null,"这是MACS2的主要功能，因为MACS2的目的就是找peak",-1),k=e("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[e("pre",{class:"shiki shiki-themes vitesse-light vitesse-dark vp-code","v-pre":""},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 常规的peak calling")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"macs2"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," callpeak"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -t"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ChIP.bam"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -c"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," Control.bam"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -f"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," BAM"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -g"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," hs"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -n"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," test"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -B"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -q"),e("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0.01")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#A0ADA0","--shiki-dark":"#758575DD"}},"# 较宽的peak calling")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#59873A","--shiki-dark":"#80A665"}},"macs2"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," callpeak"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -t"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," ChIP.bam"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -c"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," Control.bam"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," --broad"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," -g"),e("span",{style:{"--shiki-light":"#B56959","--shiki-dark":"#C98A7D"}}," hs"),e("span",{style:{"--shiki-light":"#A65E2B","--shiki-dark":"#C99076"}}," --broad-cutoff"),e("span",{style:{"--shiki-light":"#2F798A","--shiki-dark":"#4C9A91"}}," 0.1")])])]),e("div",{class:"line-numbers","aria-hidden":"true"},[e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"}),e("div",{class:"line-number"})])],-1),m=n('<p>主要参数介绍如下：</p><p><strong>输入文件参数：</strong></p><ul><li><code>-t/--treatment</code>: 处理样本输入文件</li><li><code>-c/--control</code>: 对照样本输入文件，该样本会作为call peak的对照进行处理</li><li><code>-f/--format</code>: 用来声明输入的文件格式，目前MACS能够识别的格式有<code>ELAND</code>, <code>BED</code>, <code>ELANDMULTI</code>, <code>ELANDEXPORT</code>, <code>ELANDMULTIPET</code>, <code>SAM</code>, <code>BAM</code>, <code>BOWTIE</code>, <code>BAMPE</code>, <code>BEDPE</code>. 其中除<code>BAMPE</code>, <code>BEDPE</code>需要特别声明外，其他格式都可以自动检测。<code>BAMPE</code>和<code>BEDPE</code>指的是paired-end的BAM和BED格式文件。</li><li><code>-g</code>表示有效基因组大小，由于基因组序列的重复性，基因组实际可以mapping的大小小于原始的基因组。MACS2提供了<code>hs</code> for human (2.7e9), <code>mm</code> for mouse (1.87e9), <code>ce</code> for C. elegans (9e7) and <code>dm</code> for fruitfly (1.2e8)</li></ul><p><strong>输出文件参数：</strong></p><ul><li><code>--outdir</code>:输出结果的存储路径</li><li><code>-n</code>:输出文件名的前缀</li><li><code>-B/--bdg</code>:以bedGraph格式存放fragment pileup, control lambda, -log10pvalue 和log10qvale. <ul><li><code>NAME_treat_pileup.bdg</code>: 处理后数据</li><li><code>NAME_control_lambda.bdg</code>： 对照的局部lambda值</li><li><code>NAME_treat_pvalue.bdg</code>： 泊松检验的P值</li><li><code>NAME_treat_qvalue.bdg</code>：Benjamini–Hochberg–Yekutieli处理后的Q值</li></ul></li></ul><p><strong>peak calling参数：</strong></p><ul><li><code>-q/--qvalue</code> 和 <code>-p/--pvalue</code>: <code>qvalue</code>默认值是0.05，与<code>pvalue</code>不能同时使用。</li><li><code>--broad</code>:peak有narrow peak和broad peak, 设置时可以call broad peak。</li><li><code>--broad-cutoff</code>: 和<code>pvalue</code>一样，在设置<code>--broad</code>时生效。用于call broad peak的阈值。</li><li><code>--nolambda</code>: 不要考虑在峰值候选区域的局部偏差/λ</li></ul><p><strong>Shift 模型参数：</strong></p><ul><li><code>--nomodel</code>:不使用shift模型，这个参数和extsize、shift是配套使用的，有这个参数才可以设置extsize和shift。</li><li><code>--extsize</code>:当设置了nomodel时，MACS会用--extsize这个参数从5’-&gt;3’方向扩展reads修复fragments。比如说你的转录因子结合范围200bp，就设置这个参数是200。</li><li><code>--shift</code>:当设置了–nomodel，MACS用这个参数从5’ 端移动剪切，然后用–extsize延伸，如果–shift是负值表示从3’端方向移动。建议ChIP-seq数据集这个值保持默认值为0，对于检测富集剪切位点如DNAsel数据集设置为EXTSIZE的一半。 <ol><li>想找富集剪切位点，如DNAse-seq，所有5’端的序列reads应该从两个方向延伸，如果想设置移动的窗口是200bp，参数设置如下：<code>--nomodel --shift -100 --extsize 200</code></li><li>对nucleosome-seq数据，用核小体大小的一半进行extsize,所以参数设置如下：<code>--nomodel --shift 37 --extsize 73</code></li></ol></li><li><code>--call-summits</code> MACS利用此参数重新分析信号谱，解析每个peak中包含的subpeak。对相似的结合图谱，推荐使用此参数，当使用此参数时，输出的subpeak会有相同的peak边界，不同的绩点和peak summit poisitions.</li></ul><h2 id="macs2模型原理" tabindex="-1"><a class="header-anchor" href="#macs2模型原理"><span>MACS2模型原理</span></a></h2><p>正如MACS的名字所示, Model-based Analysis of ChIP-seq, 它需要先建立模型然后分析。那么问题来了，建立什么模型？模型的目的是什么？这里的模型指的是双峰模型，建立双模模型的目的是为了更好的将原始reads朝3&#39;偏移，更好的表示蛋白和DNA的作用位置。这里还要多问一句为什么要偏倚。</p><p>这需要从实验建库说起。ChIP-seq目标是<strong>找到蛋白和DNA的作用位置</strong>，所以先要让蛋白和DNA进行交联，之后用超声打碎，再用抗体把与蛋白结合的DNA收集起来测序。在MACS发表的2008年，那个时候的测序大多都以单端50bp为主，而超声破碎的片段肯定大于50 bp（这可以通过电泳图来了解），也就是说最开始的SE50数据比对到参考基因组之后，得到的峰图并没有真实反映出原来的文库情况。但由于比对到基因组正负链的概率是相似的，那么就会形成两个峰（如下图），为了更好的还原出最来的文库片段，就先建立了双峰模型，以两峰距离d的一半作为偏倚长度。</p><blockquote><p>如果你的数据是SE50或者SE100，为了更准确地找peak，你需要建立双峰模型，你可能要调整--bw, --mfold, --fix-bimodal, --shift, --extsize。 但是对于双端测序而言，它本身测的就是文库的两端，因此建立模型没有必要，偏倚也没有必要，只需要设置参数<code>--nomodel</code>，使用paired-end模式进行分析。</p></blockquote><h2 id="reference" tabindex="-1"><a class="header-anchor" href="#reference"><span>Reference</span></a></h2>',14),g={href:"https://bioinformatics-core-shared-training.github.io/cruk-summer-school-2018/ChIP/Practicals/Practical3_peakcalling_SS.html",target:"_blank",rel:"noopener noreferrer"},u={href:"https://blog.csdn.net/BoringFantasy/article/details/80622699",target:"_blank",rel:"noopener noreferrer"},A=e("li",null,"https://blog.csdn.net/u012110870/article/details/102804191",-1);function f(C,b){const a=s("ExternalLinkIcon");return o(),c("div",null,[r,h,p,k,m,e("ol",null,[e("li",null,[e("a",g,[i("Practical 3: ChIP-seq Peak calling"),l(a)])]),e("li",null,[e("a",u,[i("MACS -- Model-based Analtsis of ChiP-Seq 原理"),l(a)])]),A])])}const E=t(d,[["render",f],["__file","index.html.vue"]]),_=JSON.parse(`{"path":"/bioinfo/macs2/","title":"peak calling工具-MACS2","lang":"zh-CN","frontmatter":{"title":"peak calling工具-MACS2","author":"Jeason","createTime":"2023/12/25 19:35:05","permalink":"/bioinfo/macs2/","tags":["biosoftware"],"description":"MACS2是peak calling最常用的工具 callpeak用法 这是MACS2的主要功能，因为MACS2的目的就是找peak 主要参数介绍如下： 输入文件参数： -t/--treatment: 处理样本输入文件 -c/--control: 对照样本输入文件，该样本会作为call peak的对照进行处理 -f/--format: 用来声明输入的文...","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"],["meta",{"property":"og:url","content":"https://jeason.netlify.app/bioinfo/macs2/"}],["meta",{"property":"og:title","content":"peak calling工具-MACS2"}],["meta",{"property":"og:description","content":"MACS2是peak calling最常用的工具 callpeak用法 这是MACS2的主要功能，因为MACS2的目的就是找peak 主要参数介绍如下： 输入文件参数： -t/--treatment: 处理样本输入文件 -c/--control: 对照样本输入文件，该样本会作为call peak的对照进行处理 -f/--format: 用来声明输入的文..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-20T07:36:48.000Z"}],["meta",{"property":"article:author","content":"Jeason"}],["meta",{"property":"article:tag","content":"biosoftware"}],["meta",{"property":"article:modified_time","content":"2024-08-20T07:36:48.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"peak calling工具-MACS2\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-08-20T07:36:48.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Jeason\\"}]}"]]},"headers":[{"level":2,"title":"callpeak用法","slug":"callpeak用法","link":"#callpeak用法","children":[]},{"level":2,"title":"MACS2模型原理","slug":"macs2模型原理","link":"#macs2模型原理","children":[]},{"level":2,"title":"Reference","slug":"reference","link":"#reference","children":[]}],"isBlogPost":true,"readingTime":{"minutes":4.01,"words":1203},"git":{"updatedTime":1724139408000},"autoDesc":true,"filePathRelative":"bioinfo/macs2.md","categoryList":[{"type":10001,"name":"bioinfo"}]}`);export{E as comp,_ as data};
